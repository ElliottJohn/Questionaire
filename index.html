<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.1/handlebars.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="/assets/js/app.js"></script>


<html class="gradient" lang=en>
    <head>
        <title>Questionaire</title>
        <link rel="stylesheet" type="text/css" href="dist/assets/css/main.css">
        <script type="text/javascript">

            localStorage.clear();
            var session = {
                'SubmittedAnswers': []
            };

            function back_button()
            { 
                session.SubmittedAnswers.length = 0;
                $( ".remove" ).remove();
                $("ul").hide(500);
                $("#back_btn").hide(500);
                $("form").show(500);

            }

            $(function() 
            {
                $("ul").hide();
                $("#back_btn").hide();
                $.getJSON('/dist/jquery/data.json', function(data) 
                {
                    for (i=0; i < data.question.length; i++)
                    {
                        var questions = "<p>" + data.question[i].label + "</p>";
                        var options = {'options': []};
                        $(".js-form").append(questions);   
                        for (n=0; n < data.question[i].options.length; n++)
                        {
                            var q_options = data.question[i].options[n];
                            options.options[n] = "<label> <input type=" + q_options.type +" name=" + q_options.name + " id=" + q_options.id + " value=" + q_options.value + ">" + q_options.label + "</label>";

                            $(".js-form").append(options.options[n]); 
                            $("input[type=radio]").addClass("radio_btn");
                            $("input[type=radio]").attr("required", true);
                        }
                    }
                });

            });

            function loadResults()
            {

                $(".radio_btn:checked").each(function(){
                    session.SubmittedAnswers.push($(this).val());
                });

                $.getJSON('/dist/jquery/data.json', function(data) 
                {
                    for (i=0; i < data.question.length; i++)
                    {
                        var results = "<h3 class='remove'>" + data.question[i].label + "</h3> <p class='remove'> Your answer was '" + session.SubmittedAnswers[i].replace(/_/g, ' ') + "' the correct answer was '" + data.question[i].answer + "'. </p>";
                        $(".js-results").append(results);   
                    }
                });

                $("form").hide(500);
                $("ul").show(500);
                $("#back_btn").show(500);
            };

        </script>
    </head>

    <div class="container">

        <body>
            <header>
                <img class="header_img" src="dist/assets/images/cohaesus.png" alt="logo" />
                <h1 class="header" id="title">Questionaire</h1>
            </header>

            <section>   
            </section>

            <form class="form" action="javascript:loadResults();">
                <div class="js-form questions">
                </div>
                <input type="submit" value="Submit">
            </form>

            <ul class="results">
                <div class="js-results">
                    <h1> Results </h1>
                </div>
            </ul>
            <div class="buttons" id="buttons">
                <button id="back_btn" type="button" onClick="javascript:back_button();"> Back </button>
            </div>
            <footer class="footer">
                Cohaesus
            </footer>
        </body>
    </div>
</html>