<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.1/handlebars.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

<html class="gradient" lang=en>
    <head>
        <title>Questionaire</title>
        <link rel="stylesheet" type="text/css" href="dist/assets/css/main.css">
        <script type="text/javascript">
            localStorage.clear();
            var session = {
              'SubmittedAnswers': []
            };
            function loadAnswers()
            { 
                document.write(localStorage.session);

            }

            $(function() 
            {
                $("ul").hide();
                $.getJSON('/dist/jquery/data.json', function(data) 
                {
                    for (i=0; i < data.question.length; i++)
                    {
                        var questions = "<p>" + data.question[i].label + "</p>";
                        var options = {'options': []};
                        $(".js-form").append(questions);   
                        for (n=0; n < data.question[i].options.length; n++)
                        {
                            var q_options = data.question[i].options[n];
                            options.options[n] = "<label> <input type=" + q_options.type +" name=" + q_options.name + " id=" + q_options.id + " value=" + q_options.value + ">" + q_options.label + "</label>";

                            $(".js-form").append(options.options[n]); 
                            $("input[type=radio]").addClass("radio_btn");
                            $("input[type=radio]").attr("required", true);
                        }  
                        //$("p").addClass("questions");

                    }
                    $("input[type=radio]").on("click", function() 
                    {
                        session.SubmittedAnswers.push({ 'Question': $(this).attr("name"), 'answer': $(this).attr("value")});
                    });
                });

            

            });

            function loadResults()
            {
            var retrievedAnswers = localStorage.getItem('session');
            var UserAnswers = JSON.parse(retrievedAnswers);

                $.getJSON('/dist/jquery/data.json', function(data) 
                {
                    for (i=0; i < data.question.length; i++)
                    {
                        var results = "<h3>" + data.question[i].label + " <p> Your answer was '" + UserAnswers.SubmittedAnswers[i].answer + "' the correct answer was '" + data.question[i].answer + "'. </p>";
                        $(".js-results").append(results);   
                    }
                    
                });

                $("form").hide(500);
                $("ul").show();
            };

        </script>

    </head>
    <body>
        <header>
            <img class="header_img" src="dist/assets/images/cohaesus.png" alt="logo" />
            <h1 class="header" id="title">Questionaire</h1>
        </header>

        <section>   
        </section>

        <form class="form" action="javascript:loadResults();">
            <div class="js-form questions">
            </div>
            <input type="submit" value="Submit" onClick="localStorage.setItem('session', JSON.stringify(session));">
        </form>


        <ul>
            <div class="js-results results">
                <h1> Results </h1>
            </div>
        </ul>


    </body>


</html>